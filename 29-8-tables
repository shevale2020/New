CREATE TABLE [dbo].[OutboundFilesSummaries] (
    [EntityID]             NVARCHAR (15)  NOT NULL,
    [OutboundFileName]     NVARCHAR (100) NOT NULL,
    [RegistrationNumber]   NVARCHAR (100) NOT NULL,
    [InvoiceFileName]      NVARCHAR (100) NOT NULL,
    [LocalFilePath]        NVARCHAR (250) NULL,
    [SFTPFilePath]         NVARCHAR (250) NULL,
    [IsFileUploadedToSFTP] BIT            DEFAULT ((0)) NOT NULL,
    [SFTPUploadTime]       DATETIME       NULL,
    CONSTRAINT [PK_dbo.OutboundFilesSummaries] PRIMARY KEY CLUSTERED ([EntityID] ASC, [OutboundFileName] ASC, [RegistrationNumber] ASC, [InvoiceFileName] ASC),
    CONSTRAINT [FK_dbo.OutboundFilesSummaries_dbo.OutboundProcessingSummaries_EntityID_OutboundFileName] FOREIGN KEY ([EntityID], [OutboundFileName]) REFERENCES [dbo].[OutboundProcessingSummaries] ([EntityID], [OutboundFileName]) ON DELETE CASCADE
);


GO
CREATE NONCLUSTERED INDEX [IX_EntityID_OutboundFileName]
    ON [dbo].[OutboundFilesSummaries]([EntityID] ASC, [OutboundFileName] ASC);




---------------------------------------------


CREATE TABLE [dbo].[OutboundProcessingSummaries] (
    [EntityID]                NVARCHAR (15)  NOT NULL,
    [OutboundFileName]        NVARCHAR (100) NOT NULL,
    [LocalFilePath]           NVARCHAR (250) NULL,
    [SFTPFilePath]            NVARCHAR (250) NULL,
    [IsFileUploadedToSFTP]    BIT            NOT NULL,
    [IsReadyForArchival]      BIT            NOT NULL,
    [IsArchived]              BIT            NOT NULL,
    [ExportedTillTime]        DATETIME       NOT NULL,
    [TotalRows]               INT            NOT NULL,
    [ProcessingWorkstation]   NVARCHAR (250) NULL,
    [ProcessingStartedTime]   DATETIME       NULL,
    [ProcessingCompletedTime] DATETIME       NULL,
    [SFTPUploadTime]          DATETIME       NULL,
    CONSTRAINT [PK_dbo.OutboundProcessingSummaries] PRIMARY KEY CLUSTERED ([EntityID] ASC, [OutboundFileName] ASC),
    CONSTRAINT [FK_dbo.OutboundProcessingSummaries_dbo.OutboundEntities_EntityID] FOREIGN KEY ([EntityID]) REFERENCES [dbo].[OutboundEntities] ([EntityID]) ON DELETE CASCADE
);


GO
CREATE NONCLUSTERED INDEX [IX_EntityID]
    ON [dbo].[OutboundProcessingSummaries]([EntityID] ASC);

----------------------------------------------------------


CREATE TABLE [dbo].[InboundProcessingSummaries] (
    [EntityID]                NVARCHAR (15)   NOT NULL,
    [InboundFileName]         NVARCHAR (100)  NOT NULL,
    [InboundFileSource]       NVARCHAR (25)   NULL,
    [LocalSourceFilePath]     NVARCHAR (250)  NULL,
    [SFTPSourceFilePath]      NVARCHAR (250)  NULL,
    [FileGeneratedTime]       DATETIME        NULL,
    [RowsTotal]               INT             NOT NULL,
    [RowsInserted]            INT             NOT NULL,
    [RowsUpdated]             INT             NOT NULL,
    [RowsCopiedToHistory]     INT             NOT NULL,
    [RowsSuccessful]          INT             NOT NULL,
    [RowsFailed]              INT             NOT NULL,
    [IsProcessed]             BIT             NOT NULL,
    [IsResultUploadedToSFTP]  BIT             NOT NULL,
    [IsReadyForArchival]      BIT             NOT NULL,
    [IsArchived]              BIT             NOT NULL,
    [LocalSuccessFilePath]    NVARCHAR (250)  NULL,
    [SFTPSuccessFilePath]     NVARCHAR (250)  NULL,
    [LocalFailedFilePath]     NVARCHAR (250)  NULL,
    [SFTPFailedFilePath]      NVARCHAR (250)  NULL,
    [ProcessingWorkstation]   NVARCHAR (250)  NULL,
    [ProcessingStartedTime]   DATETIME        NULL,
    [ProcessingCompletedTime] DATETIME        NULL,
    [SFTPDownloadTime]        DATETIME        NULL,
    [SFTPUploadTime]          DATETIME        NULL,
    [ArchivalTime]            DATETIME        NULL,
    [ProcessingSummary]       NVARCHAR (MAX)  NULL,
    [PreProcessingResult]     NVARCHAR (1000) NULL,
    [PostProcessingResult]    NVARCHAR (1000) NULL,
    CONSTRAINT [PK_dbo.InboundProcessingSummaries] PRIMARY KEY CLUSTERED ([EntityID] ASC, [InboundFileName] ASC),
    CONSTRAINT [FK_dbo.InboundProcessingSummaries_dbo.InboundEntities_EntityID] FOREIGN KEY ([EntityID]) REFERENCES [dbo].[InboundEntities] ([EntityID]) ON DELETE CASCADE
);


GO
CREATE NONCLUSTERED INDEX [IX_EntityID]
    ON [dbo].[InboundProcessingSummaries]([EntityID] ASC);

