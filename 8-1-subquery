select
PONumber,
GRNNumber,
ASSET_TYPE,
TAG_COUNT,
TAG_TYPE,
EXP_TYPE,
MAJOR_CATEGORY,
MINOR_CATEGORY,
SubMinorCategory,
Location,
INV_TYPE,
ItemCode,
--'<option value=''''> </option>'+@MakeTelecom as MakeTelDrp -- need to add dropdown at top from master for Telecom
--,'<option value=''''> </option>'+@ModelTelecom  as ModelTelDrp -- need to add dropdown at top from master for server
--,'<option value=''''> </option>'+@StockStausTelecom  as StockStatusTelDrp -- need to add dropdown at top from master for server
--,'<option value=''''> </option>'+@DeviceLifeTelecom  as DevicelifeTelDrp -- need to add dropdown at top from master for server
--,
Po_line_id,
VendorName,
PODate,
GRNDate,
 --'<option value=''''> </option>'+@SubMinorCategory as SubMinCategory
--,
sum(QUANTITY)as QUANTITY,
sum(Repeat) as Repeat

  from  (select 
  a.PONumber ,  b.GRNNumber
, isnull(c.ASSET_TYPE,'IT') as ASSET_TYPE,c.TAG_COUNT,c.TAG_TYPE,c.EXP_TYPE,c.MAJOR_CATEGORY,c.MINOR_CATEGORY, '' as SubMinorCategory
, c.INVENTORY_ORG as Location
,c.INV_TYPE
,((cast( CAST(LTRIM(RTRIM(b.QUANTITY)) as decimal) as bigint )) ) as QUANTITY
,a.ItemCode 
--,'<option value=''''> </option>'+@MakeTelecom as MakeTelDrp -- need to add dropdown at top from master for Telecom
--,'<option value=''''> </option>'+@ModelTelecom  as ModelTelDrp -- need to add dropdown at top from master for server
--,'<option value=''''> </option>'+@StockStausTelecom  as StockStatusTelDrp -- need to add dropdown at top from master for server
--,'<option value=''''> </option>'+@DeviceLifeTelecom  as DevicelifeTelDrp -- need to add dropdown at top from master for server
----  ,@AssetType as AssetType,@Make as Make,@Make as Model,@StockStatus as StockStatus
,'' as Po_line_id
----,a.LineDescription
,b.Vendor_Name as VendorName
,a.POCreationDate as PODate
,b.GRNDate
--, '<option value=''''> </option>'+@SubMinorCategory as SubMinCategory

,(c.TAG_COUNT * ((cast( CAST(LTRIM(RTRIM(b.QUANTITY)) as decimal) as bigint )) )) as Repeat
from WNS_PO_DETAILS_V(nolock) a inner join WNS_RCV_TRANSACTIONS(nolock) b
on a.PONumber=b.PONumber and a.ItemCode=b.ItemCode AND a.LineNum=b.PO_LINE_NUM
inner join WNS_ITEM_MSTER_V (nolock)c on c.ItemCode=a.ItemCode and c.INVENTORY_ORG=a.INVENTORY_ORG

  --left join @Tel   e on e.ItemCode=b.ItemCode
where 
-- a.PONumber= '3640000145' and GRNNumber='5640000462'
a.PONumber='4130000017'  and ( b.GRNNumber in (select List as GRNNumberList  from uft_Split('6130000050',',')) )
and c.INV_TYPE='Telecom' and c.ASSET_TYPE='IT' and c.TAG_TYPE='Taggable' 
--and c.[ITEM_STATUS]='Active'
and b.QUANTITY is not null)as temptable
 group by
 PONumber,

GRNNumber,
ASSET_TYPE,
TAG_COUNT,
TAG_TYPE,
EXP_TYPE,
MAJOR_CATEGORY,
MINOR_CATEGORY,
SubMinorCategory,
Location,
INV_TYPE,
ItemCode,
Po_line_id,

VendorName,
PODate,
GRNDate


output:---


PONumber	GRNNumber	ASSET_TYPE	TAG_COUNT	TAG_TYPE	EXP_TYPE	MAJOR_CATEGORY	MINOR_CATEGORY	SubMinorCategory	Location	INV_TYPE	ItemCode	Po_line_id	VendorName	PODate	GRNDate	QUANTITY	Repeat
4130000017	6130000050	IT	1	Taggable	C	EQUIPMENTS & FITTINGS	TELEPHONE		WNS India SEZ Pune-4 SP Infocity Inv Org	TELECOM 	C01647		Innovative Techhub Pvt. Ltd	2018-10-05 15:19:32.000	2018-10-10 20:58:53.000	34	34
4130000017	6130000050	IT	1	Taggable	C	EQUIPMENTS & FITTINGS	TELEPHONE		WNS India SEZ Pune-4 SP Infocity Inv Org	TELECOM 	C01915		Innovative Techhub Pvt. Ltd	2018-10-05 15:19:32.000	2018-10-10 20:58:53.000	65	65
