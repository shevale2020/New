select distinct
  a.PONumber
,  b.GRNNumber
, isnull(c.ASSET_TYPE,'IT') as ASSET_TYPE
,c.TAG_COUNT
,c.TAG_TYPE
,c.EXP_TYPE
,c.MAJOR_CATEGORY
,c.MINOR_CATEGORY
, '' as SubMinorCategory
, c.INVENTORY_ORG as Location
,c.INV_TYPE
,((cast( CAST(LTRIM(RTRIM(b.QUANTITY)) as decimal) as bigint )) ) as QUANTITY
,a.ItemCode


,'' as Po_line_id
--,a.LineDescription
,a.VendorName
,a.POCreationDate as PODate
,b.GRNDate


,(c.TAG_COUNT * ((cast( CAST(LTRIM(RTRIM(b.QUANTITY)) as decimal) as bigint )) )) as Repeat
from WNS_PO_DETAILS_V(nolock) a 
inner join WNS_RCV_TRANSACTIONS(nolock) b on a.PONumber=b.PONumber and a.ItemCode=b.ItemCode AND a.LineNum=b.PO_LINE_NUM
inner join WNS_ITEM_MSTER_V (nolock)c on c.ItemCode=a.ItemCode and c.INVENTORY_ORG=a.INVENTORY_ORG

 where 

a.PONumber='3040000675'  and ( b.GRNNumber in (select List as GRNNumberList  from uft_Split('5040002587',',')) )
 and c.ASSET_TYPE='IT' and c.TAG_TYPE='Taggable' and c.[ITEM_STATUS]='Active'
and b.QUANTITY is not null 


output----
PONumber	GRNNumber	    ASSET_TYPE	TAG_COUNT	TAG_TYPE	EXP_TYPE	MAJOR_CATEGORY	        MINOR_CATEGORY	SubMinorCategory	Location	                                     INV_TYPE	 QUANTITY	  ItemCode	 Po_line_id	   VendorName	       PODate	              GRNDate                Repeat
3040000675	5040002587	IT	          1       	Taggable	O	       EQUIPMENTS & FITTINGS	TELEPHONE		                      WNS India Magarpatta SEZ Inv Org	             TELECOM 	     1	      O00946		Innovative Techhub Pvt. Ltd	2017-05-04 15:52:12.000	2017-06-28 12:39:28.000	 1
3040000675	5040002587	IT	          1	        Taggable	O	        EQUIPMENTS & FITTINGS	TELEPHONE		                      WNS India Magarpatta SEZ Inv Org	             TELECOM 	   20	        O00946		Innovative Techhub Pvt. Ltd	2017-05-04 15:52:12.000	2017-06-28 12:39:28.000	 20
